<!doctype html>
<!-- HTML5 document -->
<html lang="en">
<head>
  <!-- Character encoding -->
  <meta charset="utf-8" />

  <!-- Responsive viewport so it looks good on mobile -->
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Browser tab title -->
  <title>RAG-based Chatbot</title>

  <!-- Bootstrap 5 CSS (CDN):
       Provides layout utilities (d-flex, gap, border, etc.) and component styles (btn, badge, etc.) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Your custom CSS (served by FastAPI via /static) -->
  <link rel="stylesheet" href="/static/style.css?v=1" />

</head>

<!-- text-white sets default text color using Bootstrap -->
<body class="text-white">

  <!-- App container:
       - app-shell is your fullscreen wrapper (100vh/100vw in CSS)
       - d-flex makes it a flex row: sidebar (left) + main (right) -->
  <div class="app-shell d-flex">
    
    <!-- =========================
         Sidebar (LEFT)
         ========================= -->
    <aside class="sidebar d-flex flex-column">
      <!-- Brand/Header block -->
      <div class="brand p-3">
        <div class="d-flex align-items-center justify-content-between">
          <div>
            <div class="fw-bold fs-5">Chat</div>
            <div class="small opacity-75">Tools & status</div>
          </div>

          <!-- Optional badge example (commented out) -->
          <!-- <span class="badge text-bg-dark border border-light-subtle">v1</span> -->
        </div>
      </div>

      <!-- Sidebar controls (upload, clear, etc.) -->
      <div class="p-3 d-grid gap-2">

        <!-- Hidden file input:
             app.js clicks this when user clicks the Upload button -->
        <input id="fileInput" class="d-none" type="file" accept="application/pdf">

        <!-- Upload button:
             - #uploadBtn is used in app.js
             - spinner #uploadSpinner is shown/hidden by JS during upload -->
        <button id="uploadBtn" class="btn btn-outline-light w-100 d-flex justify-content-center align-items-center">
          <span class="btn-label">ðŸ“„ Upload PDF</span>

          <!-- Bootstrap spinner (hidden by default via d-none) -->
          <span id="uploadSpinner"
                class="spinner-border spinner-border-sm ms-2 d-none"
                role="status"
                aria-hidden="true"></span>
        </button>

        <!-- Clear chat history button:
             app.js clears messages + localStorage -->
        <button id="clearBtn" class="btn btn-outline-danger w-100">
          ðŸ§¹ Clear history
        </button>

        <!-- Clear uploaded PDF button:
             app.js calls backend /clear and resets UI -->
        <button id="cleanPdfBtn" class="btn btn-outline-blue w-100">
          ðŸ§¹ Clean the uploaded PDF
        </button>

        <!-- Selected PDF display -->
        <div class="mt-2">
          <div class="small opacity-75 mb-1">Selected PDF</div>

          <!-- file pill:
               #filePill is updated by app.js with the selected filename
               .pill class in CSS enables wrapping for long filenames -->
          <span id="filePill"
                class="badge rounded-pill text-bg-dark border border-light-subtle pill w-100 text-start">
            No PDF selected
          </span>
        </div>

        <!-- Tips block (static text) -->
        <div class="mt-3 small tips text-white-50">
          <div class="fw-semibold text-uppercase mb-2">Tips</div>

          <ul class="mt-2 mb-0">
            <li>
              If your next question is unrelated, click
              <span class="badge text-bg-danger tip-badge">Clear history</span>
            </li>

            <li>
              If the chatbot returns
              <code class="tip-code tip-keyword">æ–‡æ¡£ä¸­æœªæ‰¾åˆ°ç›¸å…³å†…å®¹</code>,
              try again with more specific keywords (names, dates, places).
            </li>

            <li>
              Upload a new document with
              <span class="badge text-bg-secondary tip-badge">Upload PDF</span>
              (or reset with
              <span class="badge text-bg-primary tip-badge">Clean the uploaded PDF</span>).
            </li>

            <li class="mt-2">
              Dev notes:
              <span class="tip-label">Endpoints</span>
              <code class="tip-code">/upload</code>, <code class="tip-code">/chat</code>
              Â· <span class="tip-label">Storage</span>
              <code class="tip-code">localStorage</code>
            </li>
          </ul>
        </div>
      </div>

      <!-- Footer pushed to bottom by flex layout:
           mt-auto pushes this block to the bottom of the sidebar -->
      <div class="mt-auto p-3 border-top border-light border-opacity-10 small opacity-75">
        Â© CHC - Chinese History and Culture
      </div>
    </aside>

    <!-- =========================
         Main content (RIGHT)
         ========================= -->
    <main class="main flex-grow-1 d-flex flex-column">

      <!-- Top bar -->
      <div class="p-3 border-bottom border-light border-opacity-10">
        <div class="d-flex flex-column flex-md-row gap-2 justify-content-between align-items-md-center">
          <div>
            <h4 class="mb-0 text-white">ðŸ¤–Chinese Chatbot</h4>
            <div class="small opacity-75">Ask questions after uploading a PDF</div>
          </div>
        </div>
      </div>

      <!-- Chat area:
           #chat is where app.js renders message bubbles -->
      <div id="chat" class="chat-area"></div>

      <!-- Input area -->
      <div class="p-3">
        <div class="d-flex gap-2 align-items-end">

          <!-- Text input grows to fill space -->
          <div class="flex-grow-1">
            <!-- textarea:
                 #textInput used by app.js
                 Bootstrap classes give dark theme + light border -->
            <textarea id="textInput"
                      class="form-control bg-dark text-white border-light-subtle"
                      rows="2"
                      placeholder="Type a messageâ€¦ (Enter to send, Shift+Enter for newline)"></textarea>

            <div class="small opacity-75 mt-2">
              Enter to send â€¢ Shift+Enter for newline
            </div>
          </div>

          <!-- Send button:
               #sendBtn triggers chat send logic in app.js
               #sendSpinner exists but (currently) isnâ€™t toggled by JS in your code -->
          <button id="sendBtn" class="btn btn-primary px-4 d-flex align-items-center">
            <span class="btn-label">Send</span>
            <span id="sendSpinner"
                  class="spinner-border spinner-border-sm ms-2 d-none"
                  role="status"
                  aria-hidden="true"></span>
          </button>

          <!-- NOTE:
               There is a missing closing </div> here for the "d-flex gap-2" wrapper in the original file.
               Browsers will usually auto-fix it, but itâ€™s good to close it explicitly. -->
      </div>
    </main>
  </div>

  <!-- Your frontend logic (must load before using the UI):
       served from /static/app.js -->
  <script src="/static/app.js?v=1"></script>

  <!-- Bootstrap JS bundle:
       needed if you use Bootstrap JS components (offcanvas, modals, tooltips, etc.) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
